<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruleta</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="ruleta-container">
        <div id="ruleta">
            <div id="sectores">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div id="divisores">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div id="caras">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
        <div id="triangulo"></div>
        <button id="spin">Girar</button>
        <canvas id="canvas" width="400" height="400" style="display:none;"></canvas> <!-- Lienzo oculto -->
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script>
        const spinButton = document.getElementById('spin');
const ruleta = document.getElementById('ruleta');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const frames = []; // Array para almacenar los frames

spinButton.addEventListener('click', () => {
    ruleta.style.transition = 'transform 10s cubic-bezier(0,0,0.3,1)';
    const randomRotation = Math.floor(Math.random() * 360 + 720); // Rotaci贸n aleatoria
    ruleta.style.transform = `rotate(${randomRotation}deg)`;

    // Captura cada frame de la animaci贸n
    captureFrames();
});

function captureFrames() {
    const captureDuration = 10000; // Duraci贸n total de la captura en ms
    const frameDuration = 100; // Duraci贸n de cada frame en ms
    const totalFrames = captureDuration / frameDuration;

    let capturedFrames = 0;

    const interval = setInterval(() => {
        html2canvas(ruleta).then(canvas => {
            frames.push(canvas.toDataURL('image/png')); // Almacena la imagen del canvas
            capturedFrames++;

            if (capturedFrames >= totalFrames) {
                clearInterval(interval);
                createGif();
            }
        });
    }, frameDuration);
}

function createGif() {
    const gif = new GIF({
        workers: 2,
        quality: 10,
        width: canvas.width,
        height: canvas.height
    });

    frames.forEach(frame => {
        const img = new Image();
        img.src = frame;
        img.onload = () => {
            gif.addFrame(img, { delay: 100 });
        };
    });

    gif.on('finished', function(blob) {
        const url = URL.createObjectURL(blob);
        downloadGif(url);
    });

    gif.render();
}

function downloadGif(url) {
    const a = document.createElement('a');
    a.href = url;
    a.download = 'ruleta.gif';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
    </script>
</body>
</html>
